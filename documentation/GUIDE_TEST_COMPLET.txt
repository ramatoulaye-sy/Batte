ğŸ§ª GUIDE DE TEST COMPLET - BATTÃˆ APP
=====================================

Ce guide te permet de tester TOUTES les fonctionnalitÃ©s
qu'on a implÃ©mentÃ©es aujourd'hui !


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PRÃ‰PARATION (5 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : VÃ©rifier que les scripts SQL sont exÃ©cutÃ©s
----------------------------------------------------
Va sur Supabase â†’ SQL Editor

Script 1 : database/create_user_profiles_table.sql
âœ… VÃ©rifie : SELECT * FROM user_profiles LIMIT 5;

Script 2 : database/setup_rls_security_minimal.sql
âœ… VÃ©rifie : SELECT * FROM check_rls_status();
   RÃ©sultat attendu : 4 tables avec rls_enabled = true

Script 3 : database/create_missing_profiles.sql (dÃ©jÃ  fait)
âœ… VÃ©rifie : Tous les users ont un profil


Ã‰TAPE 2 : RedÃ©marrer l'app
---------------------------
Dans le terminal :

Ctrl+C (arrÃªter l'app si elle tourne)
flutter run

Attends que Ã§a compile (1-2 min)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 1 : INSCRIPTION PROGRESSIVE (10 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : Tester le nouveau flux d'inscription avec choix de profil

Ã‰TAPES :
--------
1. Sur l'Ã©cran de login, clique "Pas encore de compte ?"

2. âœ… VÃ‰RIFICATION 1 : Tu vois UNIQUEMENT les 2 cartes
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ”„ VERT     â”‚  â”‚ ğŸšš JAUNE    â”‚
   â”‚ Utilisateur â”‚  â”‚  Collecteur â”‚
   â”‚ Je recycle  â”‚  â”‚ Je collecte â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   âŒ PAS de champs visibles (Nom, Email, Password)
   âŒ PAS de bouton "S'inscrire"

3. Clique sur "UTILISATEUR" (carte verte)

4. âœ… VÃ‰RIFICATION 2 : Le formulaire APPARAÃT avec animation
   - Animation de 400ms (fade + slide)
   - Titre : "ğŸ“ Inscription Utilisateur"
   - Champs : Nom, Email, Mot de passe
   - Bouton : "S'inscrire"

5. Teste le changement :
   - Clique sur "COLLECTEUR" (carte jaune)
   - âœ… Le titre change : "ğŸšš Inscription Collecteur"
   - Les champs restent visibles

6. Remplis le formulaire :
   - Nom : "Test User"
   - Email : "testuser@mail.com"
   - Mot de passe : "test123"

7. Clique "S'inscrire"

8. âœ… VÃ‰RIFICATION 3 : Redirection automatique
   - Message : "Inscription rÃ©ussie ! Connexion en cours..."
   - Attente 1 seconde
   - â†’ HomeScreen s'affiche
   - Navbar visible en bas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 2 : INSCRIPTION COLLECTEUR (10 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : Tester le flux collecteur complet

Ã‰TAPES :
--------
1. Logout (va dans ParamÃ¨tres â†’ DÃ©connexion)

2. Retour au login â†’ "Pas encore de compte ?"

3. Clique sur "COLLECTEUR" (carte jaune)

4. âœ… VÃ‰RIFICATION : Titre "ğŸšš Inscription Collecteur"

5. Remplis :
   - Nom : "Test Collector"
   - Email : "collector@mail.com"
   - Mot de passe : "collect123"

6. Clique "S'inscrire"

7. âœ… VÃ‰RIFICATION : Formulaire collecteur s'affiche
   - Business name
   - Licence
   - VÃ©hicule
   - Rayon

8. Remplis le formulaire collecteur :
   - Business : "Mon Business Test"
   - Licence : "RC-TEST-001"
   - VÃ©hicule : "Camion Toyota - GN-999-ABC"
   - Rayon : 10

9. Clique "CrÃ©er mon profil collecteur"

10. âœ… VÃ‰RIFICATION : Dashboard Collecteur s'affiche
    - Stats : Collectes, Gains, Rayon, Note
    - Toggle : Disponible/Indisponible
    - Pas d'overflow (pas de bandes jaunes)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 3 : SÃ‰PARATION DES PROFILS (10 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : VÃ©rifier qu'un utilisateur ne peut pas accÃ©der au mauvais dashboard

TEST 3A : UTILISATEUR â†’ Ne peut pas aller au dashboard collecteur
------------------------------------------------------------------
1. Logout
2. Login avec testuser@mail.com

3. âœ… VÃ‰RIFICATION : Tu arrives au HomeScreen
   - Navbar : Home, Recyclage, Budget, Education, Services
   - Stats : Solde, Eco-score visible

4. Essaie de forcer l'accÃ¨s au dashboard collecteur :
   - Dans Cursor, ouvre lib/app.dart
   - Cherche la route '/collector-dashboard'
   - Essaie d'y accÃ©der manuellement (ne devrait pas Ãªtre possible via l'UI)
   
   âœ… Si tu y arrives quand mÃªme, tu seras AUTOMATIQUEMENT redirigÃ© vers /home
   (GrÃ¢ce Ã  la vÃ©rification dans collector_dashboard_screen.dart)

TEST 3B : COLLECTEUR â†’ Ne peut pas aller au HomeScreen utilisateur
-------------------------------------------------------------------
1. Logout
2. Login avec collector@mail.com (ou halima@batte.com)

3. âœ… VÃ‰RIFICATION : Tu arrives au Dashboard Collecteur
   - Stats collecteur visibles
   - Toggle disponibilitÃ©

4. Essaie de forcer l'accÃ¨s au HomeScreen :
   - Si tu essaies d'y aller, tu seras AUTOMATIQUEMENT redirigÃ© vers /collector-dashboard
   (GrÃ¢ce Ã  la vÃ©rification dans home_screen.dart)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 4 : REDIRECTION AUTOMATIQUE AU LOGIN (5 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : VÃ©rifier que le login redirige vers le bon dashboard

1. Logout

2. Login avec un compte UTILISATEUR (ex: testuser@mail.com)
   âœ… Va direct au HomeScreen (pas de choix intermÃ©diaire)

3. Logout

4. Login avec un compte COLLECTEUR (ex: halima@batte.com)
   âœ… Va direct au Dashboard Collecteur (pas de choix)

5. âœ… VÃ‰RIFICATION : Plus de ProfileChoiceScreen
   Le systÃ¨me dÃ©tecte automatiquement le profil


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 5 : SPLASH SCREEN (2 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : Tester la redirection au dÃ©marrage

1. Ferme complÃ¨tement l'app (Ctrl+C)

2. Relance : flutter run

3. Attends le splash screen (3 secondes)

4. Si tu es UTILISATEUR â†’ âœ… Va au HomeScreen
   Si tu es COLLECTEUR â†’ âœ… Va au Dashboard Collecteur
   Si pas connectÃ© â†’ âœ… Va au LoginScreen


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 6 : RLS SUPABASE - SÃ‰CURITÃ‰ (10 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : VÃ©rifier que les donnÃ©es sont protÃ©gÃ©es cÃ´tÃ© serveur

TEST 6A : Voir uniquement ses propres donnÃ©es
----------------------------------------------
1. Connecte-toi avec testuser@mail.com dans l'app

2. Va sur Supabase â†’ Authentication â†’ Users
   Note l'ID de testuser

3. Va sur Supabase â†’ Table Editor â†’ transactions
   Clique "RLS enabled" en haut

4. âœ… VÃ‰RIFICATION : Tu ne vois QUE les transactions de testuser
   (Pas les transactions des autres utilisateurs)

TEST 6B : Impossible d'avoir 2 profils
---------------------------------------
1. Va sur Supabase â†’ SQL Editor

2. Essaie d'insÃ©rer un 2Ã¨me profil pour testuser :

   INSERT INTO user_profiles (user_id, profile_type)
   VALUES (
     (SELECT id FROM users WHERE email = 'testuser@mail.com'),
     'collector'
   );

3. âœ… VÃ‰RIFICATION : Tu devrais avoir une ERREUR
   "Un utilisateur ne peut avoir qu'un seul profil"
   
   C'est normal ! Le trigger empÃªche les doublons.

TEST 6C : VÃ©rifier les fonctions helper
----------------------------------------
1. Dans Supabase SQL Editor, exÃ©cute :

   SELECT user_has_profile_type('user');

2. Si tu es connectÃ© en tant qu'utilisateur :
   âœ… RÃ©sultat : true

3. ExÃ©cute :

   SELECT user_has_profile_type('collector');

4. Si tu es utilisateur :
   âœ… RÃ©sultat : false


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 7 : ANIMATION DU FORMULAIRE (2 min)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objectif : Voir l'animation fluide

1. Logout

2. "Pas encore de compte ?"

3. Regarde bien l'Ã©cran (cartes uniquement)

4. Clique sur "UTILISATEUR"

5. âœ… VÃ‰RIFICATION : Le formulaire apparaÃ®t avec :
   - Fade in (apparition progressive en 400ms)
   - Slide up (glisse lÃ©gÃ¨rement vers le haut)
   - Transition fluide et professionnelle

6. Clique sur "COLLECTEUR"
   âœ… Le titre change instantanÃ©ment


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST 8 : VALIDATION TEMPS RÃ‰EL (Ã€ VENIR)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Note : Les fichiers de validation sont crÃ©Ã©s mais pas encore intÃ©grÃ©s.
On peut les intÃ©grer aprÃ¨s si tu veux.


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CHECKLIST COMPLÃˆTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Coche au fur et Ã  mesure :

â–¡ Les 2 cartes (Utilisateur/Collecteur) s'affichent
â–¡ Les champs apparaissent APRÃˆS le choix
â–¡ Animation fluide (fade + slide)
â–¡ Inscription utilisateur â†’ HomeScreen
â–¡ Inscription collecteur â†’ Formulaire collecteur â†’ Dashboard
â–¡ Login utilisateur â†’ HomeScreen direct
â–¡ Login collecteur â†’ Dashboard collecteur direct
â–¡ Dashboard collecteur sans overflow
â–¡ Utilisateur ne peut pas accÃ©der au dashboard collecteur
â–¡ Collecteur ne peut pas accÃ©der au HomeScreen utilisateur
â–¡ RLS activÃ© sur les 4 tables
â–¡ Trigger empÃªche les profils multiples
â–¡ Chaque utilisateur voit uniquement ses donnÃ©es


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SI UN TEST Ã‰CHOUE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLÃˆME : L'animation ne s'affiche pas
SOLUTION : VÃ©rifie que animated_form_reveal.dart existe dans lib/widgets/

PROBLÃˆME : Erreur au login
SOLUTION : VÃ©rifie les logs, cherche "âŒ" dans le terminal

PROBLÃˆME : Redirection incorrecte
SOLUTION : VÃ©rifie que tous les utilisateurs ont un profil :
   SELECT u.email, up.profile_type 
   FROM users u 
   LEFT JOIN user_profiles up ON u.id = up.user_id;

PROBLÃˆME : RLS bloque tout
SOLUTION : VÃ©rifie que les politiques sont correctes dans Supabase

PROBLÃˆME : Dashboard collecteur overflow
SOLUTION : DÃ©jÃ  corrigÃ© ! RedÃ©marre l'app.


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RÃ‰SUMÃ‰ DES TESTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Tests minimaux Ã  faire :
1. Inscription utilisateur (5 min)
2. Inscription collecteur (5 min)
3. Login avec les 2 types (2 min)

Tests approfondis :
4. VÃ©rifier RLS dans Supabase (5 min)
5. Tester l'animation (2 min)
6. Tester les redirections automatiques (5 min)

TEMPS TOTAL : 15-25 minutes


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PROCHAINES Ã‰TAPES APRÃˆS LES TESTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si tout fonctionne :
âœ… Photos de profil (upload avatar)
âœ… Notifications push
âœ… IntÃ©gration de la validation temps rÃ©el dans les formulaires

Si problÃ¨mes :
âŒ Regarde les logs dans le terminal
âŒ Cherche les messages d'erreur "âŒ"
âŒ Dis-moi le problÃ¨me, je corrige !


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
COMMANDES UTILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RedÃ©marrer l'app :
  Ctrl+C
  flutter run

Voir les logs en temps rÃ©el :
  (Les logs s'affichent automatiquement dans le terminal)

Nettoyer le projet :
  flutter clean
  flutter pub get
  flutter run

VÃ©rifier les erreurs :
  flutter analyze --no-fatal-infos


COMMENCE PAR LE TEST 1 (INSCRIPTION) ! ğŸš€

